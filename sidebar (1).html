<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <!-- The CSS package above applies Google styling to buttons and other elements. -->

    <style>
      .branding-below {
        bottom: 56px;
        top: 0;
      }
      .branding-text {
        left: 7px;
        position: relative;
        top: 3px;
      }
      .col-contain {
        overflow: hidden;
      }
      .col-one {
        float: left;
        width: 50%;
      }
      .logo {
        vertical-align: middle;
      }
      .radio-spacer {
        height: 20px;
      }
      .width-100 {
        width: 100%;
      }
    
      <!-- Styling the tabs-->
      /* Style the tab */
      .tab {
      overflow: hidden;
      border: 1px solid #ccc;
      background-color: #f1f1f1;
      }
          
      /* Change background color of buttons on hover */
      .tab button:hover {
      background-color: #ddd;
      }
      
      /* Create an active/current tablink class */
      .tab button.active {
      background-color: #ccc;
      }
    
      /* Style the tab content */
      .tabcontent {
      display: none;
      padding: 6px 12px;
      border: 1px solid #ccc;
      border-top: none;
      }
        
      /* Dropdown Button */
      .dropbtn {
      background-color: #3498DB;
      color: black;
      padding: 6px 12px;
      font-size: 16px;
      border: none;
      cursor: pointer;
      }
    
      /* Dropdown button on hover & focus */
      .dropbtn:hover, .dropbtn:focus {
      background-color: #2980B9;
      }
      
      /* The container <div> - needed to position the dropdown content */
      .dropdown {
      position: relative;
      display: inline-block;
      }
      
      /* Dropdown Content (Hidden by Default) */
      .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f1f1f1;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
      }
    
      /* Links inside the dropdown */
      .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      }
  
      /* Change color of dropdown links on hover */
      .dropdown-content a:hover {background-color: #ddd}
  
      /* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
      .show {display:block;}

      /*Styling the scroll menu*/
      div.scrollmenu {
        background-color: #333;
        overflow: auto;
        white-space: nowrap;
      }

      div.scrollmenu a {
        display: inline-block;
        color: white;
        text-align: center;
        padding: 14px;
        text-decoration: none;
      }

      div.scrollmenu a:hover {
        background-color: #777;
      }

      .card {
        box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);
        transition: 0.3s;
        width: 100%;
      }

      .card:hover {
        box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2);
      }

      .container {
        padding: 2px 16px;
      }
    </style>
  </head>
  
  <body>
  <!--
      <div class="block" id="button-bar">
          <button class = "blue" id = "word-finder">Word Finder</button>
          <button class="blue" id="run-translation">Word Count</button>
          <!-- <button id="insert-text">Insert</button> 
          <button class="blue" id="run-LT">LT api test</button>
          <button class="blue" id="run-stat">stat test</button>
          <p id = "text_body_test">
          # of words:  
          </p>
      </div>
      
    -->
  
      <!--dropdown menu-->
      <div class="dropdown">
        <button onclick="myFunction()" class="dropbtn" style = "margin:20px;">Word Options</button>
        <div id="myDropdown" class="dropdown-content">
          <center><button class="tablinks" style="width:200px" onclick="openTab(event, 'Error Checker'); google.script.run.showFunctionality('Error Checker');">Error Checker</button></center>
          <br>
          <center><button class="tablinks" style="width:200px" onclick="openTab(event, 'Thesaurus'); google.script.run.showFunctionality('Thesaurus');">Thesaurus</button></center>
          <br>
          <center><button class="tablinks"  style="width:200px" onclick="openTab(event, 'Word Finder'); google.script.run.showFunctionality('Word Finder');">Word Finder</button></center>
          <br>
          <center><button class="tablinks" style="width:200px" onclick="openTab(event, 'Word Statistics'); google.script.run.showFunctionality('Word Statistics');">Word Statistics</button></center>
          <br>
          <center><button class="tablinks"  style="width:200px" onclick="openTab(event, 'Word Counter'); google.script.run.showFunctionality('Word Counter');">Word Counter</button></center>
        </div>
      </div>

    <!--------------- Tab content ---------------->
    
    <!-- Error Checker -->
    <div id="Error Checker" class="tabcontent">
      <h3>Error/Grammar Checker</h3>
      <p>Text box for input: </p>
      <button class="blue" id="run-LT">Language Tool API</button>
      <div class="card">
        <div class="container">
          <p id = "text_body_error">
          Errors:
      	  </p>
        </div>
      </div>
    </div>
    
    <!-- Thesaurus -->
    <div id="Thesaurus" class="tabcontent">
     <div class="block" id="button-bar">
          <button class = "blue" id = "start_thesaurus">Thesaurus</button>
          <form id="thesaurus_form" action="">
          Word to find Synonyms/Antonyms: <input type="text" id="tname">
          <input type="button" onclick="thesaurus_run()" value="Submit">
        </form>
        <div class="card">
        <div class="container">
          <h4><p id="thesaurus_results"> </p></h4> 
        </div>
      </div>
      </div>
     </div>
      
    
    <!-- Word Counter -->
    <div id="Word Counter" class="tabcontent">
      <h3>Word Counter</h3>      
       <button class="blue" id="run-count">Word Count</button>
      <div class="card">
        <div class="container">
          <h4>Number of Words: <p id ="text_body_counter"> </p></h4> 
        </div>
      </div>
    </div>
    
    <!-- Word Statistics -->
    <div id="Word Statistics" class="tabcontent">
      <h3>Word Statistics</h3>    
      <button class="blue" id="run-stat">Stat test</button>
      <div class="card">
        <div class="container">
          <h4><p id="text_body_statistics"> </p></h4> 
        </div>
      </div>
    </div>
    
    <div id="Word Finder" class="tabcontent">
      <h3>Word Finder</h3>
      <div class="block" id="button-bar">
          <button class = "blue" id = "word-finder">Word Finder</button>
          <form id="word_to_find" action="">
          Word to search: <input type="text" id="fname">
          <input type="button" onclick="find_words()" value="Submit">
          <button onclick="deselect_text_semi()">Deselect Text</button>
        </form>
      </div>
    </div>
    
    <!-- Dictionary -->
      <form id = "word-to-define">
        <div class="block form-group">
          <label for="translated-text"><b>Dictionary:</b></label>
          <textarea class="width-100" id="translated-text" rows="1"></textarea>
          <input type="button" onclick="dictionary_run()" value="Enter">
        </div>
        <div class="card">
        <div class="container">
          <h4><p id="dictionary_results"> </p></h4> 
        </div>
      </div>
      </form>
      
    
<!--
    <div class="sidebar bottom">
      <img alt="Add-on logo" class="logo" src="https://www.gstatic.com/images/branding/product/1x/translate_48dp.png" width="27" height="27">
      <span class="gray branding-text">Translate sample by Google</span>
    </div>
-->
    
    <script>
    
       window.onload = function() {
          document.getElementById("word_to_find").style.display = "none";
       };
       
      /* When the user clicks on the button,
      toggle between hiding and showing the dropdown content */
      function myFunction() {
        document.getElementById("myDropdown").classList.toggle("show");
      }

      // Close the dropdown menu if the user clicks outside of it
      window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
          var dropdowns = document.getElementsByClassName("dropdown-content");
          var i;
          for (i = 0; i < dropdowns.length; i++) {
            var openDropdown = dropdowns[i];
            if (openDropdown.classList.contains('show')) {
              openDropdown.classList.remove('show');
            }
          }
        }
      }
      
      /**
       * On document load, assign click handlers to each button and try to load the
       * user's origin and destination language preferences if previously set.
       */
      $(function() {
        $('#run-translation').click(runTranslation);
        $('#insert-text').click(insertText);
        google.script.run.withSuccessHandler(loadPreferences)
            .withFailureHandler(showError).getPreferences();
      });
      
      //For opening tabs
      function openTab(evt, tabName) {
      // Declare all variables
      var i, tabcontent, tablinks;
      
      // Get all elements with class="tabcontent" and hide them
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
      }
      
      // Get all elements with class="tablinks" and remove the class "active"
      tablinks = document.getElementsByClassName("tablinks");
      for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
      }
      
      // Show the current tab, and add an "active" class to the button that opened the tab
      document.getElementById(tabName).style.display = "block";
      evt.currentTarget.className += " active";
      }
      
    </script>
   

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    
    <script>
    //code in this function runs when page is loaded
    $(function() {
      //$('#run-translation').click(runTranslation);
      //var myVar = setInterval(google.script.run.withSuccessHandler(count_words).get_Text(),10000);
      $('#word-finder').click(start_word_finder);
      $('#run-count').click(start_count);
      $('#run-LT').click(start_LT_check);
      $('#run-stat').click(start_stats);
      $('#thesaurus_start').click(start_thesaurus);
      //google.script.run.withSuccessHandler(count_words).get_Text();
      
    });
    
    function dictionary_run() {
      var dic_word = document.getElementById("translated-text").value;
      google.script.run.withSuccessHandler(final_dictionary).Dictionary(dic_word);
    }
    
    function final_dictionary(results) {
      var list = $('#dictionary_results');
      list.empty();
      list.append("<p>" + results + "</p>");
    }
    
    function start_thesarus() {
      document.getElementById("thesaurus_form").style.display = "block";
    }
    
    function thesaurus_run() {
      var thes_word = document.getElementById("tname").value;
      google.script.run.withSuccessHandler(final_thesaurus).Thesaurus_finder(thes_word);
    }
    
    function final_thesaurus(results) {
      var list = $('#thesaurus_results');
      list.empty();
      list.append("<p>" + results + "</p>");
    }
    
    
    
    function start_word_finder(){
      document.getElementById("word_to_find").style.display = "block";
      //this function waits for button click
    }
   
    function final_find(doctext){
    //this function takes the desired word, and finds it in the text
    var background = '#F3E2A9';
      var word_to_find = document.getElementById("fname").value;
      google.script.run.withSuccessHandler(finalize).highlightText(word_to_find,doctext,background);
    }
    function find_words(){
       google.script.run.withSuccessHandler(final_find).get_Text();
    }
    function deselect_text_semi(){
    //this function takes the desired word, and finds it in the text
      google.script.run.withSuccessHandler(deselect_text_final).get_Text();
    }
    function deselect_text_final(doctext){
    //this function takes the desired word, and finds it in the text
    var background = '#FFFFFF';
      var word_to_find = document.getElementById("fname").value;
      google.script.run.withSuccessHandler(finalize).highlightText(word_to_find,doctext,background);
    }
    function finalize(){}
    
    function start_count(){
      google.script.run.withSuccessHandler(count_words).get_Text();
    }
    
    //asynchronous function for counting words in the doc
    function count_words(text_body_test){
      var list = $('#text_body_counter');
      list.empty();
      //for(var i = 0; i < text_body_test.length; i++){
        //list.append(text_body_test[i]);
      //}
      var words = text_body_test.replace(/\s+/g, " ").split(" ");
      list.append(words.length);
    }
    
    //starts the function to call the language tool api
    function start_LT_check(){
      document.getElementById("word_to_find").style.display = "none";
      google.script.run.withSuccessHandler(run_LT_check).get_Text(); 
    }
    
    //Sub process to call the LT api
    function run_LT_check(documentText){
      
      google.script.run.withSuccessHandler(get_LT_results).call_LT_api(documentText);
    }
    
    //Finally, parse through the JSON response from the API, for now the free LT api version catches a limited amount of mistakes 
    function get_LT_results(resultJSON){
      var list = $('#text_body_error');
      list.empty();
      
      var suggestion;
      var source;
      var card;
      
      for(var i = 0; i < resultJSON.length; i++){
        suggestion = JSON.stringify(resultJSON[i].message);
        source = JSON.stringify(resultJSON[i].sentence);
        card = ("<div class=\"card\"> <div class=\"container\">" + 
                    "<h4><b>" + suggestion + "</b></h4>" + 
                    "<p>From sentence: " + source + "</p>" +
                    "</div> </div>");
        list.append(card);
      }
      
      //list.append(JSON.stringify(resultJSON));
    }
    
    function start_stats(){
      google.script.run.withSuccessHandler(wordStats).get_Text();
    }
    
    function wordStats(text_body_test){
      var list = $('#text_body_statistics');
      list.empty();
      //for(var i = 0; i < text_body_test.length; i++){
        //list.append(text_body_test[i]);
      //}
      var txt = "The National Basketball Association is an American men's professional basketball league. It is composed of 30 teams and is one of the four major professional sports leagues in the United States and Canada. It is the premier men's professional basketball league in the world. "
        //for(var i = 0; i < text_body_test.length; i++){
          //list.append(text_body_test[i]);
        //}*/
        var words = text_body_test.replace(/\s+/g, " ").split(" ");
        //list.append("# of words: " + words.length);
        //console.log(words) 
    
        var dict = new Map();
        
        //create a new HashMap for characters
        var char_dict = new Map();
     
        var i;
     
        for(i=0; i < words.length; i++)
        {
          //if the word is in the dict 
          if(dict.has(words[i]))
          {
          
          //increment count
          
            dict.set(words[i],dict.get(words[i])+1);
          }
          else
          {
           
           //add word to map
            
            dict.set(words[i],1);
          }
          //then loop through given word, take each character, and add to the map
          for(var j = 0; j < words[i].length; j++ )
          {
            if(char_dict.has(words[i].charAt(j)))
            {
              
             //increment 
              
              
              char_dict.set(words[i].charAt(j),char_dict.get(words[i].charAt(j))+1);
    
              
            }
            else
            {
              //add to map
              char_dict.set(words[i].charAt(j),1);
              
            
            }
          }
        
        }
        //if there isn't more than 3 words one cannot run wordStats
        if(dict.size < 3)
        {
          list.append("Error, their must be at least three words to run this function.");
        }
        
        var element = 0;
        var firstPlace = dict.get(words[0]);
        var secondPlace = dict.get(words[1]);
        var thirdPlace = dict.get(words[2]);
    
        var firstPlaceName = words[0];
        var secondPlaceName = words[1];
        var thirdPlaceName = words[2];
    
    //loop through both maps and find 1st,2nd, and 3rd place values
        for (const [key, value] of dict.entries()) 
        {
            if(value > firstPlace)
            {
              
              thirdPlace = secondPlace;
              thirdPlaceName = secondPlaceName;
              
              secondPlace = firstPlace
              secondPlaceName = firstPlaceName;
              
              firstPlace = value;
              firstPlaceName = key;
            }
            else if(value > secondPlace)
            {
              
              thirdPlace = secondPlace;
              thirdPlaceName = secondPlaceName;
              
              secondPlace = value;
              secondPlaceName = key;
    
            }
            else if(value > thirdPlace)
            {s
              
              thirdPlace = value;
              thirdPlaceName = key;
            }  
          }
    
          var firstPlace_char = 0;
          var secondPlace_char = -1;
          var thirdPlace_char = -2;
          var firstPlaceName_char = "xx";
          var secondPlaceName_char = "xx";
          var thirdPlaceName_char = "xx";
    
         for (const [key, value] of char_dict.entries()) 
        {
            if(value > firstPlace_char)
            {
              
              thirdPlace_char = secondPlace_char;
              thirdPlaceName_char = secondPlaceName_char;
              
              secondPlace_char = firstPlace_char;
              secondPlaceName_char = firstPlaceName_char;
              
              firstPlace_char = value;
              firstPlaceName_char = key;
            }
            else if(value > secondPlace_char)
            {
              
              thirdPlace_char = secondPlace_char;
              thirdPlaceName_char = secondPlaceName_char;
              
              secondPlace_char = value;
              secondPlaceName_char = key;
    
            }
            else if(value > thirdPlace_char)
            {
              
              thirdPlace_char = value;
              thirdPlaceName_char = key;
            }  
          }
    
       //output results
        list.append("WORD STATISTICS");
        list.append("<p></p>");
        list.append("--------------------------");
        list.append("<p></p>");
        list.append("Most used word:  <font color=\"red\"> " +"\"" + firstPlaceName +"\"" +"</font>, with <mark> " + firstPlace + "</mark> occurrences");
        list.append("<p></p>");
        list.append("Second most used word:  <font color=\"red\"> "+"\""  + secondPlaceName + "\""+"</font>, with <mark> " + secondPlace + "</mark> occurrences");
        list.append("<p></p>");
        list.append("Third most used word:  <font color=\"red\"> " +"\"" + thirdPlaceName + "\""+ "</font>, with <mark> " + thirdPlace + "</mark> occurrences");
        list.append("<p></p>");
        list.append("---------------------------");
        list.append("<p></p>");
        list.append("Most used character:  <font color=\"red\"> " +"\"" + firstPlaceName_char +"\""  + "</font>, with <mark> " + firstPlace_char + "</mark> occurrences");
        list.append("<p></p>");
        list.append("Second most used character:  <font color=\"red\"> " +"\"" + secondPlaceName_char +"\""  + "</font>, with <mark> " + secondPlace_char + "</mark> occurrences");
        list.append("<p></p>");
        list.append("Third most used character:  <font color=\"red\"> " +"\"" + thirdPlaceName_char +"\""  + "</font>, with <mark> " + thirdPlace_char + "</mark> occurrences");
        list.append("<p></p>");
        list.append("---------------------------")
        list.append("<p></p>");
        list.append("There were a total of  <font color=\"red\"> " + words.length + "</font> words");
        list.append("<p></p>");
         var numOfChars = 0;
         for(var i = 0; i < words.length;i++)
         {
           numOfChars = numOfChars + words[i].length;
          // console.log(numOfChars)
         }
    
         list.append("There were a total of  <font color=\"red\"> " + numOfChars +"</font> characters");
         list.append("<p></p>");
         var average = numOfChars/words.length;
         list.append("The average length of word was <font color=\"red\"> " + Math.floor(average) + " </font>characters, with the chances of <mark>" +"\"" + firstPlaceName_char+"\""  +"</mark> appearing in a given word to be  <font color=\"red\"> " + Math.round(100*(firstPlace_char/numOfChars) * average) +"%</font>, <mark> " +"\"" + secondPlaceName_char +"\"" + "</mark> with a  <font color=\"red\"> " + Math.round(100*(secondPlace_char/numOfChars) * average) + "%</font> chance, and <mark> "+"\"" + thirdPlaceName_char +"\"" + "</mark> with a  <font color=\"red\"> " + Math.round(100*(thirdPlace_char/numOfChars) * average) +"%</font> chance");
         list.append("<p></p>");
         list.append("---------------------------");
    }
    </script>
    
  </body>
</html>